FROM spex.common:latest

# Keeps Python from generating .pyc files in the container
ENV PYTHONDONTWRITEBYTECODE 1
# Turns off buffering for easier container logging
ENV PYTHONUNBUFFERED 1

EXPOSE 80

COPY ./common /app/common
COPY ./backend /app/backend
WORKDIR /app/backend

RUN pipenv install --system --deploy --ignore-pipfile

RUN pip install seaborn matplotlib==3.5.1 MarkupSafe==2.0.1 anndata==0.8.0 scanpy==1.9.3 vitessce==3.0.5 lttb==0.3.1

CMD ["python", "app_demo.py"]